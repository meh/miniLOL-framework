/* miniLOL is released under AGPLv3. Copyleft meh. [http://meh.doesntexist.org | meh@paranoici.org] */
(function(){if(Prototype.Browser.IE)Prototype.Browser.InternetExplorer=true;if(Prototype.Browser.Gecko)Prototype.Browser.Mozilla=true;if(navigator.userAgent.match(/Chrome/))Prototype.Browser.Chrome=true;if(navigator.userAgent.match(/Safari/)&&!Prototype.Browser.Chrome)Prototype.Browser.Safari=true;if(Prototype.Browser.Mozilla||Prototype.Browser.Opera)Prototype.Browser.Good=true;else Prototype.Browser.Bad=true;Prototype.Browser.Name=window.navigator.appName;var b=window.navigator.appVersion;try{if(Prototype.Browser.IE)Prototype.Browser.Version=
parseFloat(b.match(/MSIE ([^;]*)/)[1]);else if(Prototype.Browser.Mozilla||Prototype.Browser.Opera)Prototype.Browser.Version=parseFloat(b);else throw null;}catch(c){Prototype.Browser.Version=0}if(Prototype.Browser.IE)Error.prototype.toString=function(){return"#{name}: #{description}<br/><br/>#{stack}".interpolate({name:this.name,description:this.description,stack:(this.stack||"").replace(/\n/g,"<br/>")})};else if(Prototype.Browser.Opera)Error.prototype.toString=function(){return"#{name}: #{message}".interpolate(this)};
else if(Prototype.Browser.Gecko)Error.prototype.toString=function(){return"#{name}: #{message}<br/><br/>#{stack}".interpolate({name:this.name,message:this.message,stack:this.stack.replace(/\n/g,"<br/>")})};else if(Prototype.Browser.Chrome||Prototype.Browser.Safari)Error.prototype.toString=function(){return"#{name}: #{message}<br/><br/>#{stack}".interpolate({name:this.name,message:this.message,stack:this.stack.replace(/\n/g,"<br/>")})};if(Prototype.Browser.IE){if(!window.DOMParser)window.DOMParser=
Class.create({parseFromString:function(a){var e=new AciveXObject("Microsoft.XMLDOM");e.async="false";e.loadXML(a);return e}});if(!window.XMLSerializer)window.XMLSerializer=Class.create({serializeToString:function(a){return a.xml}})}})();Function.empty=function(){};Object.extend(Function,function(){return{parse:function(b){matches=b.match(/^function\s*\((.*?)\)[\s\n]*\{([\s\S]*)\}[\s\n]*/m);if(!matches)return null;b=matches[1].split(/\s*,\s*/);return new Function(b,matches[2])}}}());
Object.extend(Function.prototype,function(){return{clone:function(){return Function.parse(this.toString())}}}());
Object.extend(Object,function(){var b,c;if(function(){for(var d in{toString:1})if(d==="toString")return false;return true}()){var a=Object.keys,e=Object.values,j=["toString","valueOf"];b=function(d){var i=a(d);j.each(function(k){d[k]!=Object.prototype[k]&&i.push(k)});return i};c=function(d){var i=e(d);j.each(function(k){d[k]!=Object.prototype[k]&&i.push(d[k])});return i}}else{b=Object.keys;c=Object.values}var f=Object.isFunction(Object.defineProperty)?Object.defineProperty:function(d,i,k){Object.isFunction(k.get)&&
Object.isFunction(d.__defineGetter__)&&d.__defineGetter__(i,k.get);Object.isFunction(k.set)&&Object.isFunction(d.__defineSetter__)&&d.__defineSetter__(i,k.set)};if(Object.isFunction(Object.defineProperties))var h=Object.defineProperties;else Object.defineProperties=function(d,i){for(var k in i)Object.defineProperty(d,k,i[k])};if(Object.isFunction(Object.create))var g=Object.create;else Object.create=function(d,i){var k=Object(d);Object.defineProperties(k,i);return k};return{isObject:function(d){return typeof d==
"object"},isBoolean:function(d){return typeof d=="boolean"||d.constructor===Boolean},isRegExp:function(d){return!Object.isUndefined(d)&&d.constructor==window.RegExp},isClass:function(d){return Boolean(d["__miniLOL.Class__"])},isDocument:function(d){return d.toString().include("Document")},isXML:function(d){if(typeof d!=="object")return false;d=d.ownerDocument||d;if(!d.documentElement)return false;return d.documentElement.nodeName!="HTML"},fromAttributes:function(d){for(var i={},k=0;k<d.length;k++)i[d.item(k).nodeName]=
d.item(k).nodeName;return i},toQueryString:function(d){var i="";for(var k in d)i+="#{name}=#{value}&".interpolate({name:k,value:d[k]});return i.substr(0,i.length-1)},keys:b,values:c,extend:function(d,i,k){k=Object.isUndefined(k)?true:Boolean(k);for(var l=Object.keys(i),m=0,n=l.length;m<n;m++){var o=l[m];if(k||Object.isUndefined(destionation[o]))d[o]=i[o]}return d},extendAttributes:function(d,i,k){k=Object.isUndefined(k)?true:Boolean(k);for(var l in i)if(k||Object.isUndefined(destionation[l]))(function(){var m;
d[l]=function(n,o){return Object.isUndefined(n)&&!o?Object.isFunction(i[l].get)?i[l].get(m):m:Object.isFunction(i[l].set)?m=i[l].set(m,n):m=n}})();return d},without:function(d,i){var k=Object.extend({},d);if(Object.isArray(i))i.each(function(l){delete k[l]});else delete k[i];return k},defineProperty:f,defineProperties:h,create:g}}());
Object.extend(String,function(){return{fromAttributes:function(b){for(var c="",a=0;a<b.length;a++)c+='#{name}="#{value}" '.interpolate({name:b.item(a).nodeName,value:b.item(a).nodeValue});return c},fromXML:function(b){if(!Object.isXML(b))return false;return(new XMLSerializer).serializeToString(b)}}}());
Object.extend(String.prototype,function(){function b(f){Object.isRegExp(f)||(f=/&/);var h={},g=this.match(/[?#](.*?)([#?]|$)/);if(!g)return h;f=g[1].split(f);for(g=0;g<f.length;g++){var d=f[g].split(/=/),i=d[0].decodeURIComponent();if(d=d[1])if(Object.isUndefined(h[i]))h[i]=d.decodeURIComponent();else if(Object.isArray(h[i]))h[i].push(d);else h[i]=[h[i],d];else h[i]=true}return h}var c=window.encodeURI,a=window.decodeURI,e=window.encodeURIComponent,j=window.decodeURIComponent;return{toQueryParams:b,
parseQuery:b,toXML:function(){return(new DOMParser).parseFromString(this,"text/xml")},isURL:function(){return/^(\w+):(\/\/.+?(:\d)?)(\/)?/.test(this)||/^mailto:([\w.%+-]+@[\w.]+\.[A-Za-z]{2,4})$/.test(this)},parseURL:function(){var f;if(f=this.match(/^mailto:(([\w.%+-]+)@([\w.]+\.[A-Za-z]{2,4}))$/))return{protocol:"mailto",uri:f[1],user:f[2],host:f[3]};if(f=this.match(/^((\w+):\/\/(((.+?)(:(\d+))?)(\/.*)?))$/))return{full:f[1],protocol:f[2],uri:f[3],host:f[4],hostname:f[5],port:f[7],path:f[8]};return false},
blank:function(){return this==0},getHashFragment:function(){var f=this.match(/(#.*)$/);return f?f[1]:""},splitEvery:function(f){for(var h=[],g=0;g<this.length;g+=f)h.push(this.substr(g,f));return h},test:function(f){return f.test(this)},commonChars:function(f){return this.toArray().intersect(f.toArray())},format:function(f){var h=this;for(var g in f)h=h.replace(RegExp("\\{"+g+"\\}","g"),f[g].toString());return h},reverse:function(){return this.toArray().reverse().join("")},translate:function(f,h){var g=
this;h?Object.keys(f).each(function(d){if(!h[d])throw Error("The second table value is missing.");g=f[d].is(RegExp)?g.replace(eval(f[d].global?f[d].toString():f[d].toString()+"g")):g.replace(RegExp(f[d],"g"),h[d])}):Object.values(f).each(function(d){if(d.length!=2)throw Error("The array has to be [regex, translation].");g=d[0].is(RegExp)?g.replace(eval(d[0].global?d[0].toString():d[0].toString()+"g"),d[1]):g.replace(RegExp(d[0],"g"),d[1])});return g},toNumber:function(f){return f?parseInt(this):parseFloat(this)},
toBase:function(f){return this.toNumber().toBase(f)},fromBase:function(f){return parseInt(this,f)},toCode:function(){return this.charCodeAt(0)},toPaddedString:function(f,h,g){h=Object.isUndefined(g||h)?"0":(g||h).toString();return h.times(f-this.length)+this},toInvertedCase:function(){for(var f="",h=0,g=this.length;h<g;h++){var d=this.charAt(h),i=d.toLowerCase(),k=d.toUpperCase();f+=k==i?i:d==i?k:i}return f},encodeURI:function(){return c(this)},decodeURI:function(){return a(this)},encodeURIComponent:function(){return e(this)},
decodeURIComponent:function(){return j(this)}}}());
Object.extend(Number.prototype,function(){function b(){return this*1E3}function c(){return this}function a(){return this*60}function e(){return this*60*60}function j(){return this*60*60*24}function f(){return this*60*60*24*7}function h(){return this*60*60*24*375}return{milliseconds:b,ms:b,seconds:c,second:c,minutes:a,minute:a,hours:e,hour:e,days:j,day:j,weeks:f,week:f,years:h,year:h,upTo:function(g,d,i){$R(this,g+1,true).each(d,i);return this},isEven:function(){return this%2==0},isOdd:function(){return this%
2!=0},abs:function(){return Math.abs(this)},round:function(){return Math.round(this)},ceil:function(){return Math.ceil(this)},floor:function(){return Math.floor(this)},log:function(){return Math.log(this)},pow:function(g){return Math.pow(this,g)},sqrt:function(){return Math.sqrt(this)},sin:function(){return Math.sin(this)},cos:function(){return Math.cos(this)},tan:function(){return Math.tan(this)},asin:function(){return Math.asin(this)},acos:function(){return Math.acos(this)},atan:function(){return Math.atan(this)},
toPaddedString:function(g,d,i){i=Object.isUndefined(i)?"0":i.toString();d=this.toString(d||10);return i.times(g-d.length)+d},toBase:function(g){return this.toString(g).toUpperCase()},toChar:function(){return String.fromCharCode(this)},digits:function(){var g=this.toString().match(/e(.*)$/);return g?g[1].toNumber()>0?1+g[1].toNumber():0:this.toString().length},ordinalized:function(){switch(parseInt(this)){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}}}());
Hash.addMethods(function(){var b=Hash.prototype.toJSON;return{remove:Hash.prototype.unset,clear:function(){var c=this._object;this._object={};return c},replace:function(c){var a=this._object;this._object=Object.isString(c)?miniLOL.JSON.unserialize(c):Object.extend({},c);return a},toJSON:function(c){return c?miniLOL.JSON.serialize(this._object)||"{}":b.call(this)}}}());
(function(){Date.weekDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.months=["January","February","March","April","May","June","July","August","September","October","November","December"];var b={d:2,H:2,I:2,j:3,k:2,l:2,m:2,M:2,N:9,S:2,U:2,V:2,W:2,y:2,i:3};Object.extend(Date,function(){var a=Date.parse;return{parse:function(e){if(!e.include("%"))return a(e)}}}());var c={flag:{"-":function(a){return a},_:function(a,e){return a.toPaddedString(e,10," ")},"0":function(a,
e){return a.toPaddedString(e,10,"0")},"^":function(a,e){return a.toString().toUpperCase().toPaddedString(e," ")},"#":function(a,e){return a.toString().toInvertedCase().toPaddedString(e," ")}},"%":function(){return"%"},a:function(a){return Date.weekDays[a.getDay()].substr(0,3)},A:function(a){return Date.weekDays[a.getDay()]},b:function(a){return Date.months[a.getMonth()].substr(0,3)},B:function(a){return Date.months[a.getMonth()]},c:function(a){return a.format("%a %b %_d %X %Y")},C:function(a){return a.getFullYear().toString().substr(0,
2)},d:function(a){return a.getDate()},D:function(a){return a.format("%m/%d/%y")},e:function(a){return a.format("%_d")},F:function(a){return a.format("%Y-%m-%d")},g:function(a){return a.format("%y")},G:function(a){return a.format("%Y")},h:function(a){return a.format("%b")},H:function(a){return a.getHours()},I:function(a){a=a.getHours();return a+1>12?(a+1)/2:a+1},j:function(a){var e=new Date;e.setFullYear(a.getFullYear());e.setDate(1);e.setMonth(0);return((a.getTime()-e.getTime())/1E3/60/60/24).ceil()},
k:function(a){return a.format("%_H")},l:function(a){return a.format("%_l")},m:function(a){return a.getMonth()+1},M:function(a){return a.getMinutes()},n:function(){return"\n"},N:function(a){return a.getMilliseconds()*1E6},p:function(a){return a.getHours()>12?"PM":"AM"},P:function(a){return a.format("%#p")},r:function(a){return a.format("%I:%M:%S %p")},R:function(a){return a.format("%H:%M")},s:function(a){return a.getDate()},S:function(a){return a.getSeconds()},t:function(){return"\t"},T:function(a){return a.format("%H:%M:%S")},
u:function(a){return a.getDay()==0?7:a.getDay()},U:function(a){var e=new Date;e.setFullYear(a.getFullYear());e.setDate(1);e.setMonth(0);return((a.getTime()-e.getTime())/1E3/60/60/24/7).ceil()},V:function(a){return a.format("%U")},w:function(a){return a.getDay()},W:function(a){return a.format("%U")},x:function(a){return a.format("%m/%d/%y")},X:function(a){return a.format("%T")},y:function(a){return a.getFullYear().toString().substr(2,2)},Y:function(a){return a.getFullYear()},E:function(a){if(a.getMonth()%
2==0)return 31;if(a.getMonth()==1)return a.getFullYear()%4==0?29:28;return 30},o:function(a){return a.getDate().ordinalized()},O:function(a){return a.getFullYear()%4?0:1},i:function(a){var e=new Date(a);e.setHours(0);e.setSeconds(0);e.setMinutes(0);return((a.getTime()-e.getTime())/1E3/86.4).toFixed(2)}};Object.extend(Date.prototype,function(){return{format:function(a){var e=this;return a.gsub(/%([\-_0^#])?(\d+)?(.)/,function(j){var f=j[1]||"0",h=parseInt(j[2]||b[g]||"0"),g=j[3];if(!c[g])return j[0];
return c.flag[f](c[g](e),h)})}}}())})();
window.Element.addMethods(function(){return{load:function(b,c){if(c&&!Object.isUndefined(c.frequency))new Ajax.PeriodicalUpdater(this,b,c);else new Ajax.Updater(this,b,c)},xpath:Prototype.Browser.IE?function(b,c){if(Object.isUndefined(c)){c=b;b=this}for(var a=[],e=b.selectNodes(c),j=0;j<e.length;j++)a.push(e.item(j));return a}:function(b,c){if(Object.isUndefined(c)){c=b;b=this}for(var a=[],e=(b.ownerDocument||b).evaluate(c,b,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),j=0;j<e.snapshotLength;j++)a.push(e.snapshotItem(j));
return a},select:function(b,c){if(Object.isUndefined(c)){c=b;b=this}return Prototype.Selector.select(c,b)},getTextDescendants:function(b){function c(e){for(e=e.firstChild;e;){Node.TEXT_NODE==e.nodeType&&a.push(e);Object.isElement(e)&&c(e);e=e.nextSibling}}b=b||this;var a=[];c(b);return a},getFirstText:function(b){b=b||this;var c="";if(Object.isElement(b))b=$A(b.childNodes);else Object.isArray(b)||(b=$A(b));b.each(function(a){switch(a.nodeType){case Node.ELEMENT_NODE:throw $break;case Node.CDATA_SECTION_NODE:case Node.TEXT_NODE:if(!a.nodeValue.blank()){c=
a.nodeValue.strip();throw $break;}break}});return c},toObject:function(b){b=b||this;var c={};if(!Object.isElement(b)&&!Object.isDocument(b))return c;$A(b.childNodes).each(function(a){if(a.nodeType==Node.ELEMENT_NODE)if(a.getElementsByTagName("*").length==0){var e="";$A(a.childNodes).each(function(j){j.nodeType!=Node.CDATA_SECTION_NODE&&j.nodeType!=Node.TEXT_NODE||j.nodeValue.blank()||(e+=j.nodeValue)});c[a.nodeName]=e}else c[a.nodeName]=Element.toObject(a)});return c}}}());
if(!Object.isObject(window.miniLOL))window.miniLOL={error:Function.empty,Framework:{Version:"0.1"}};
Class=function(){var b={Normal:1,Abstract:2},c=function(){return{addMethods:function(a){for(var e=this.superclass&&this.superclass.prototype,j=Object.keys(a),f=0,h=j.length;f<h;f++){var g=j[f],d=a[g];if(e&&Object.isFunction(d)&&d.argumentNames().first()=="$super"){var i=d;d=function(k){return function(){return e[k].apply(this,arguments)}}(g).wrap(i);d.valueOf=i.valueOf.bind(i);d.toString=i.toString.bind(i)}this.prototype[g]=d;if(this.__type__==Class.Abstract)this[g]=d}},addStatic:function(a){for(var e=
Object.keys(a),j=0,f=e.length;j<f;j++){var h=e[j];this[h]=a[h]}},addAttributes:function(a){Object.extendAttributes(this.prototype,a);this.__type__==Class.Abstract&&Object.extendAttributes(this,a)}}}();return{create:function(){var a=$A(arguments),e=Object.isFunction(a.first())?a.shift():null,j=function(){switch(this.__type__){case b.Abstract:throw Error("You cannot instantiate an abstract class.");default:if(Object.isFunction(this.initialize))return this.initialize.apply(this,arguments);break}return null};
j["__miniLOL.Class__"]=true;Object.extend(j,Class.Methods);j.superclass=e;j.subclasses=[];if(e){if(!e.__type__)e.__type__=b.Normal;if(!e.subclasses)e.subclasses=[];var f=Function.empty.clone();f.prototype=e.prototype;j.prototype=new f;e.subclasses.push(j)}j.__type__=j.prototype.__type__=a.first().type||Class.Normal;a.each(function(h){j.addMethods({initialize:h.initialize||h.constructor||Function.empty.clone()});j.addMethods(Object.without(h,["constructor","initialize","Methods","Static","Attributes"]));
j.addMethods(h.Methods||{});j.addStatic(h.Static||{});j.addAttributes(h.Attributes||{})});return j.prototype.constructor=j},Type:b,Methods:c}}();
miniLOL.utils=function(){return{exists:function(b){var c=false;new Ajax.Request(b,{method:"head",asynchronous:false,onSuccess:function(){c=true}});return c},get:function(b,c){var a;new Ajax.Request(b,{method:"get",minified:c,asynchronous:false,onSuccess:function(e){a=e.responseText}});return a},execute:function(b){var c,a;new Ajax.Request(b,{method:"get",asynchronous:false,evalJS:false,onSuccess:function(e){try{c=window.eval(e.responseText)}catch(j){a=j;a.fileName=b;a.lineNumber-=5}},onFailure:function(e){a=
Error("Failed to retrieve `#{file}` (#{status} - #{statusText}).".interpolate({file:b,status:e.status,statusText:e.statusText}));a.fileName=b;a.lineNumber=0}});if(a)throw a;return c},include:function(b){var c=false;new Ajax.Request(b,{method:"get",asynchronous:false,evalJS:false,onSuccess:function(a){try{window.eval(a.responseText);c=true}catch(e){c=false}}});return c},require:function(b){var c=false;new Ajax.Request(b,{method:"get",asynchronous:false,evalJS:false,onSuccess:function(a){try{window.eval(a.responseText)}catch(e){c=
e;c.fileName=b;c.lineNumber-=5}},onFailure:function(a){c=Error("Failed to retrieve `#{file}` (#{status} - #{statusText}).".interpolate({file:b,status:a.status,statusText:a.statusText}));c.fileName=b;c.lineNumber=0;c.http={status:a.status,text:a.statusText}}});if(c)throw c;return true}}}();
miniLOL.History={interval:0.15,initialize:function(){miniLOL.History.current=window.location.hash||"#";if(Prototype.Browser.Opera&&history.navigationMode)history.navigationMode="compatible";Event.observe(document,":url.change",function(b){miniLOL.History.current=b.memo.toString()||"#"});miniLOL.History.Initializers.get().call()},reset:function(b,c){if(Object.isNumber(b))miniLOL.History.interval=b;Object.isUndefined(miniLOL.History.timer)||clearInterval(miniLOL.History.timer);miniLOL.History.timer=
setInterval(c,miniLOL.History.interval*1E3)},Initializers:{get:function(){return"onhashchange"in window&&!(Prototype.Browser.InternetExplorer&&Prototype.Browser.Version==7)?miniLOL.History.Initializers.Default:Prototype.Browser.InternetExplorer?miniLOL.History.Initializers.InternetExplorer:miniLOL.History.Initializers.Unsupported},Default:function(){Event.observe(window,"hashchange",function(){Event.fire(document,":url.change",Prototype.Browser.Mozilla?window.location.hash||"#":decodeURIComponent(window.location.hash||
"#"))})},Unsupported:function(){document.observe("dom:loaded",function(){miniLOL.History.reset(miniLOL.History.interval,miniLOL.History.Checkers.Default)})},InternetExplorer:function(){document.observe("dom:loaded",function(){miniLOL.History.IE={check:function(){if(!miniLOL.History.IE.element.parentNode||miniLOL.History.IE.element.parentNode.nodeName=="#document-fragment")$(document.body).insert({top:miniLOL.History.IE.element})},put:function(b){miniLOL.History.IE.check();var c=miniLOL.History.IE.element.contentWindow.document;
c.open();c.close();c.location.hash=encodeURIComponent(b.substring(1))},get:function(){miniLOL.History.IE.check();return miniLOL.History.IE.element.contentWindow.document.location.hash},element:new Element("iframe",{id:"__miniLOL.History",style:"display: none !important; z-index: -9001 !important;",src:"javascript:false;"})};$(document.body).insert({top:miniLOL.History.IE.element});miniLOL.History.IE.put(miniLOL.History.current);miniLOL.History.reset(miniLOL.History.interval,miniLOL.History.Checkers.InternetExplorer)})}},
Checkers:{Default:function(){if(miniLOL.History.current!=window.location.hash)Event.fire(document,":url.change",Prototype.Browser.Mozilla?window.location.hash||"#":decodeURIComponent(window.location.hash||"#"))},InternetExplorer:function(){var b={iframe:miniLOL.History.IE.get(),actual:window.location.hash||"#",current:miniLOL.History.current};if(b.actual!=b.iframe){if(b.actual&&b.actual==b.current)window.location.hash=(miniLOL.History.current=b.iframe).substring(1);else miniLOL.History.IE.put(miniLOL.History.current=
b.actual);Event.fire(document,":url.change",miniLOL.History.current)}}}};miniLOL.History.initialize();
miniLOL.Resource=Class.create({initialize:function(b,c){if(!c)throw Error("No wrapper has been passed.");this.name=b;this.wrapper=c;if(!this.wrapper.clear)this.wrapper.clear=function(){this.data={}};for(var a in this.wrapper){if(Object.isFunction(this.wrapper[a])){if(this.wrapper[a].parent==this.wrapper)break;this.wrapper[a]=this.wrapper[a].bind(this.wrapper);this.wrapper[a].parent=this.wrapper}if(Object.isUndefined(this[a]))this[a]=this.wrapper[a]}this.clear();this.flush();this.wrapper.initialize&&
this.wrapper.initialize()},load:function(){var b,c=$A(arguments);Event.fire(document,":resource.load",{resource:this,arguments:c});this.calls.push(c);try{b=this.wrapper.load.apply(this.wrapper,c)}catch(a){miniLOL.error("Error while loading `#{name}` resource.\n#{error}".interpolate({name:this.name,error:a.toString()}));return false}Event.fire(document,":resource.loaded",{resource:this,arguments:c});return b},reload:function(){Event.fire(document,":resource.reload",{resource:this});this.wrapper.clear();
this.flush().each(function(b){this.load.apply(this,b)},this);Event.fire(document,":resource.reloaded",{resource:this})},clear:function(){Event.fire(document,":resource.clear",{resource:this});this.wrapper.clear()},flush:function(b){Event.fire(document,":resource.flush",{resource:this,call:b});var c;if(Object.isArray(b)){if(c=this.calls.find(function(a){if(a.length!=b.length)return false;for(var e=false,j=0;j<a.length;j++){if(b[j]==a[j])e=true;if(!e)break}return e}))this.calls=this.calls.filter(function(a){return a!=
c})}else{c=this.calls;this.calls=[]}return c},data:function(){return this.wrapper.data}});
miniLOL.JSON=function(){return{parse:function(b){return new miniLOL.JSON(b)},serializeSpecial:function(b){if(typeof b!=="object")return b;b=Object.clone(b);for(var c in b)b[c]=Object.isXML(b[c])?{__miniLOL_is_xml:true,value:String.fromXML(b[c])}:Object.isFunction(b[c])?{__miniLOL_is_function:true,value:b[c].toString()}:miniLOL.JSON.serializeSpecial(b[c]);return b},unserializeSpecial:function(b){if(typeof b!=="object")return b;b=Object.clone(b);for(var c in b)b[c]=b[c].__miniLOL_is_xml?b[c].value.toXML():
b[c].__miniLOL_is_function?Function.parse(b[c].value):miniLOL.JSON.unserializeSpecial(b[c]);return b},serialize:function(b){try{return Object.toJSON(miniLOL.JSON.serializeSpecial(b))}catch(c){return false}},unserialize:function(b){if(!Object.isString(b))return null;try{return miniLOL.JSON.unserializeSpecial(b.evalJSON())}catch(c){return null}}}}();
miniLOL.Cookie=function(){function b(f){return Object.extend({expires:new Date(Date.now()+(1).day().ms()),path:"",domain:"",secure:"",raw:false},f||{})}function c(f,h,g){if(Object.isUndefined(g))g={};return"#{key}=#{value}; #{maxAge}#{expires}#{path}#{domain}#{secure}".interpolate({key:f.encodeURIComponent(),value:h.encodeURIComponent(),maxAge:!Object.isUndefined(g.maxAge)?"max-age=#{0}; ".interpolate([g.maxAge]):"",expires:!Object.isUndefined(g.expires)?"expires=#{0}; ".interpolate([g.expires.toUTCString()]):
"",path:!Object.isUndefined(g.path)?"path=#{0}; ".interpolate([g.path]):"",domain:!Object.isUndefined(g.domain)?"domain=#{0}; ".interpolate([g.domain]):"",secure:g.secure?"secure":""})}function a(){var f=[];window.document.cookie.split(/; /).each(function(h){h=h.split(/=/);f.push(h[0])});return f.uniq()}function e(f,h){h=b(h);var g=window.document.cookie.match(RegExp.escape(f.encodeURIComponent())+"=([^;]*)","g");if(g){var d=[];$A(g).each(function(i){i=i.match(/^.*?=(.*)$/)[1].decodeURIComponent();
d.push(h.raw?i:miniLOL.JSON.unserialize(i)||i)});if(d.length==1)d=d[0];return d}}function j(f,h){window.document.cookie=c(f,"",Object.extend(b(h),{expires:new Date(0)}))}return Object.extend(Enumerable,{_each:function(f){a().each(function(h){var g=e(h),d=[h,g];d.name=h;d.key=h;d.value=g;f(d)})},encode:c,keys:a,get:e,set:function(f,h,g){g=b(g);g.raw||(h=miniLOL.JSON.serialize(h)||h);window.document.cookie=c(f,h,g)},remove:j,unset:j,clear:function(){a().each(function(f){j(f)})}})}();
miniLOL.Storage=Class.create({initialize:function(b,c){this.name=b;this.backend=miniLOL.Storage.Instances[b]?miniLOL.Storage.Instances[b]:miniLOL.Storage.Instances[b]=new (c||miniLOL.Storage.Backends.available())(b)},get:function(b){return this.backend.get(b.toString())},set:function(b,c,a){return this.backend.set(b.toString(),c,a)},remove:function(b,c){return this.backend.remove(b.toString(),c)},clear:function(b){return this.backend.clear(b)},size:function(){return this.backend.size},save:function(){this.backend.save()}});
miniLOL.Storage.Instances={};
miniLOL.Storage.Backend=Class.create(Hash,{initialize:function($super,c,a){$super((Object.isString(a)?miniLOL.JSON.unserialize(a):a)||{});this.name=miniLOL.Storage.Backend.filter(c);if(Object.isString(a))this.size=a.size},get:function($super,c){return $super(c)},set:function($super,c,a,e){c=$super(c,a);e||this.save();return c},remove:function($super,c,a){c=$super(c);a||this.save();return c},clear:function($super,c){var a=$super();c||this.save();return a},replace:function($super,c){this.size=Object.isString(c)?
c.length:0;return $super(c)},Static:{filter:function(b){return b.replace(/\s/g,"")}}});
miniLOL.Storage.Backends={available:function(){try{return window.localStorage?miniLOL.Storage.Backends.LocalStorage:window.globalStorage?miniLOL.Storage.Backends.GlobalStorage:document.body.addBehavior?miniLOL.Storage.Backends.UserDataBehavior:miniLOL.Storage.Backends.Cookie}catch(b){return miniLOL.Storage.Backends.Null}},LocalStorage:Class.create(miniLOL.Storage.Backend,{initialize:function($super,c){$super(c);this.replace(window.localStorage["__miniLOL.storage."+this.name]||"{}")},save:function(){var b=
this.toJSON(true);this.size=b.length;window.localStorage["__miniLOL.storage."+this.name]=b}}),GlobalStorage:Class.create(miniLOL.Storage.Backend,{initialize:function($super,c){$super(c);this.replace(window.globalStorage[window.location.hostname]["__miniLOL.storage."+this.name]||"{}")},save:function(){var b=this.toJSON(true);this.size=b.length;window.globalStorage[window.location.hostname]["__miniLOL.storage."+this.name]=b}}),UserDataBehavior:Class.create(miniLOL.Storage.Backend,{initialize:function($super,
c){$super(c);this.element=document.createElement("link");this.element.addBehavior("#default#userData");$$("head")[0].appendChild(this.element);this.element.load("__miniLOL.storage."+c);var a=this.element.getAttribute("__miniLOL.storage."+this.name)||"{}";this.size=a.length;this.replace(a)},save:function(){var b=this.toJSON(true);this.size=b.length;this.element.setAttribute("__miniLOL.storage."+this.name,b);this.element.save("__miniLOL.storage."+this.name)}}),Cookie:Class.create(miniLOL.Storage.Backend,
{initialize:function($super,c){$super(c);this.replace(miniLOL.Cookie.get("__miniLOL.storage."+this.name,{raw:true})||"{}")},save:function(){var b=this.toJSON(true);this.size=b.length;miniLOL.Cookie.set("__miniLOL.storage."+this.name,b,{expires:31536E3,raw:true})}}),Null:Class.create(miniLOL.Storage.Backend,{save:Function.empty})};
miniLOL.Document=function(){return{fix:Prototype.Browser.IE?function(b){if(b){b={real:b};b.documentElement=b.real.documentElement;b.getElementsByTagName=function(c){return this.real.getElementsByTagName(c)};b.getElementById=function(c){return Element.xpath(this,"//*[@id='#{0}']".interpolate([c])).first()}.bind(b.real);b.real.setProperty("SelectionLanguage","XPath");b.xpath=Element.xpath.bind(b.real);b.select=Element.select.bind(b.real);return b}}:Prototype.Browser.Good?function(b){if(b){b.xpath=Element.xpath;
b.select=Element.select;return b}}:function(b){if(b){b.getElementById=function(c){return this.xpath("//*[@id='#{0}']".interpolate([c])).first()};b.xpath=Element.xpath;b.select=Element.select;return b}},check:function(b,c){var a=false;b||(a="There is a syntax error.");if(b.documentElement.nodeName=="parsererror")a=b.documentElement.textContent;if(c&&a){miniLOL.error("Error while parsing #{path}\n\n#{error}".interpolate({path:c,error:a}),true);return a}return a}}}();
miniLOL.CSS=function(){return{include:function(b,c){if(c)c=b.replace(/\.css$/,".min.css");var a=$$("link").find(function(e){return e.getAttribute("href")==b||e.getAttribute("href")===c});if(!a){if(c&&miniLOL.utils.exists(c))b=c;else if(!miniLOL.utils.exists(b))return false;a=new Element("link",{rel:"stylesheet",href:b,type:"text/css"});$$("head")[0].insert(a);Event.fire(document,":css.included",a)}return a},create:function(b,c){var a=new Element("style",{type:"text/css"});if(Prototype.Browser.IE)a.styleSheet.cssText=
b;else a.update(b);c&&a.setAttribute("id",c);$$("head").first().appendChild(a);Event.fire(document,":css.created",a);return a}}}();
